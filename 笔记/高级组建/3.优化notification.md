在notification 是close的情况下将节点在dom中删掉，同时把vm对象删除，减少内存占用，要在消失动画结束后清除

## 1. 给transition添加事件 - 动画结束 afterLeave

```jsx
  <transition name="fade">
    <div
      v-show="visible"
      class="notification"
      :style="style"
      @after-leave="afterLeave"
    >
      <span class="content">{{ content }}</span>
      <a
        class="btn"
        @click="handleClose"
      >{{ btn }}</a>
    </div>
  </transition>
  
  methods: {
    handleClose (e) {
      e.preventDefault()
      // 即将关闭
      this.$emit('close')
    },
    afterLeave () {
      // 已经关闭 - 在外部 function监听事件
      this.$emit('closed')
    }
  }
```

function.js

```javascript
// 删除节点
const removeInstance = (instance) => {
  if (!instance) return
  // const len = instance.length
  const index = instances.findIndex(inst => instance.id === inst.id)
  // 删掉节点
  instances.splice(index, 1)
}

  instance.vm.$on('closed', () => {
    // 删除节点
    removeInstance(instance)
    // 删除dom 节点
    document.body.removeChild(instance.vm.$el)
    // 只会删除vm对象，不会删除dom节点
    instance.vm.$destroy()
  })

  vm.$on('close', () => {
    console.log('close')
    vm.visible = false
  })
```

## 2.点击close组件消失,并且上面往下移动
function.js
```javascript
  // 点击close关闭
  instance.vm.$on('close', () => {
    instance.vm.visible = false
  })

  // 当关闭后删除节点，同时处理位置移动
  vm.$on('closed', () => {
    console.log('closed')
    // 删除节点
    removeInstance(instance)
    // 删除dom 节点
    document.body.removeChild(vm.$el)
    // 只会删除vm对象销毁事件绑定，不会删除dom节点
    vm.$destroy()
  })

  // 删除节点
const removeInstance = (instance) => {
  if (!instance) return
  const len = instances.length
  const index = instances.findIndex(inst => instance.id === inst.id)
  // 删掉节点
  instances.splice(index, 1)

  if (len <= 1) return

  const removeHeight = instance.height
  console.log(removeHeight, 'removeHeight')
  for (let i = index; i < len; i++) {
    console.log('instances[i]', instances[i])
    instances[i].verticalOffset = parseInt(instances[i].verticalOffset - removeHeight - 16)
    console.log('instances[i].verticalOffset', instances[i].verticalOffset)
  }
}
```


## 2. 点击关闭关闭

```javascript
  vm.$on('close', () => {
    console.log('close')
    vm.visible = false
  })
```

