## 通过function调用notification

## 1. 使用extends扩展组件
创建func-notification.js


## 2.创建function.js
要控制组件样式
notification.js中添加

```javascript
import Component from './func-notification'
import Vue from 'vue'
// 使用Vue.extend 创建一个组件 也可以使用new vue
const NotificationConstructor = Vue.extend(Component)
// 2.可能有多个组件
const instances = []

// 3.生成组件id
let seed = 1
// 1. 要控制组件定位
const notify = (options) => {
  // 判断是服务端则不处理，需要进行dom操作
  if (Vue.prototype.$isServer) return
  const instance = new NotificationConstructor({
    propsData: options
  })
  const id = `notification_${seed++}`
  instance.id = id
  // 生成$el 对象，但没有插入页面
  const vm = instance.$mount()
  document.body.appendChild(vm.$el)

  // 计算高度
  let verticalOffset = 0
  instances.forEach(item => {
    // 不同的标签之间的间隙
    verticalOffset += item.$el.offsetHeight + 16
  })
  // 与默认边框的距离
  verticalOffset += 16
  instance.verticalOffset = verticalOffset
  instance.push(instance)
  return instance.vm
}

export default notify

```
## 3. func-notification.js 设置位置style

```javascript
import Notification from './notification.vue'

export default {
  // extends 新声明的属性可以直接覆盖
  extends: Notification,
  computed: {
    style () {
      return {
        position: 'fixed',
        right: '20px',
        bottom: `${this.verticalOffset}px`
      }
    }
  },
  data () {
    return {
      verticalOffset: 0
    }
  }
}

```

## 4.index.js 中导出
```javascript
import Notification from './notification.vue'
import notify from './function'
// 在使用vue.install时候会接受一个参数，
// 全局注册 Notification
export default (Vue) => {
  Vue.component(Notification.name, Notification)
  // 每个组件都可以直接调用
  Vue.prototype.$notify = notify
}

```
## 5.app.vue中使用

```javascript
  mounted () {
    this.$notify({
      content: 'test $notify',
      btn: 'close'
    })
  }
```


## 6.添加自动关闭功能
func-notification.js中添加定时器
```javascript
  mounted () {
    this.createTimer()
  },
  methods: {
    createTimer () {
      if (this.autoClose) {
        this.timer = setTimeout(() => {
          this.visible = false
        }, this.autoClose)
      }
    }
  },
  data () {
    return {
      verticalOffset: 0,
      autoClose: 3000
    }
  }
}
```


### 1.添加过渡效果  v-show="visible"

notification.js
```jsx
<template>
  <transition name="fade">
    <div
      class="notification"
      :style="style"
      v-show="visible"
    >
      <span class="content">{{ content }}</span>
      <a
        class="btn"
        @click="handleClose"
      >{{ btn }}</a>
    </div>
  </transition>
</template>
  data () {
    return {
      visible: true
    }
  },
```
### 2.包装组件的时候使用 覆盖data
function
```javascript
const notify = (options) => {
  const {
    autoClose,
    ...rest
  } = options
  // 判断是服务端则不处理，需要进行dom操作
  if (Vue.prototype.$isServer) return
  const instance = new NotificationConstructor({
    propsData: {
      ...rest
    },
    data: {
      autoClose: autoClose === undefined ? 3000 : autoClose
    }
  })

```
## 7.解决跨域问题 - webpack-devserver
```javascript

const devServer = {
  port: 8001,
  host: '0.0.0.0', // 可以通过IP访问，其他设备也可以
  overlay: {
    errors: true // 显示错误
  },
  // 允许跨域 -- 仅在开发过程中
  headers: {
    'Access-Control-Allow-Origin': '*'
  },
```
